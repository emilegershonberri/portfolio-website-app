!function(e){var n="object"==typeof globalThis&&globalThis||"object"==typeof window&&window||"object"==typeof self&&self;try{var t=n.performance,o=n.Promise,r=n.MessageChannel,a=n.requestAnimationFrame;if(!(t&&t.mark&&o&&r&&a))return;var s=function(n){return t.mark("chunk-"+e+"-"+n)},f=!1,i=!1,c=o.resolve();s("exec-start");for(var u=0;u<5;u++)c=c.then();if(c.then((function(){s("exec-sync-end")})),"undefined"!=typeof window){var l=function(){f&&!i&&(s("after-paint"),i=!0)},p=new r;p.port1.onmessage=l,p.port2.postMessage(null),setTimeout(l),a((function(){f=!0,s("raf"),p.port2.postMessage(null),setTimeout(l)}))}}catch(e){n.__jsPerformanceMarksError=e}}("icloudlinks.main");(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{2530:function(e,t,n){},2531:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i,r=n(3229),o=n(2355);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}!function(e){e.getCMMOwner=function(e){var t,n;return null==e||null==(t=e.owner)||null==(n=t.userIdentity)?void 0:n.nameComponents},e.getNameOrEmailString=function(e){if(e){var t=e.owner.userIdentity,n=t.nameComponents,i=t.lookupInfo,o=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language;return{shortName:n.givenName||(null==i?void 0:i.emailAddress)||"",fullName:Object(r.a)(o,n)||(null==i?void 0:i.emailAddress)||""}}},e.getCMMCountsByOwner=function(e){if(e){var t={you:0,others:0};if(0===e.length)return t;for(var n,i=function(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return a(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,void 0):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e);!(n=i()).done;){var r=n.value;Object(o.a)(r)?t.you++:t.others++}return t}}}(i||(i={}))},2532:function(e,t,n){},2533:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(1678),r=n(2534),o=n(1661),a=n(2123),s=n(1795),u=n(1796),l={};function c(e,t){var n=r.a.instance.getPreviewData(t);if(n)return{isLoading:!1,data:n,promise:Promise.resolve(i.Result.success(n))};var c=e.fields.previewData;if(!c||!c.downloadURL)return{isLoading:!1,promise:Promise.resolve(i.Result.failure(new s.a({errorCode:"MissingPreviewData",message:"No download URL found on CMM root for preview data hydrator"})))};var d=l[u.a.zoneKeyString(t)];if(d)return{promise:d,isLoading:!0};var m=new Promise((function(e){fetch(c.downloadURL).then((function(n){n.arrayBuffer().then((function(n){if(n)try{var o=new Uint8Array(n),u=a.a.decode(o);if(u.previewImageData){var l=new Image;l.src=window.URL.createObjectURL(new Blob(u.previewImageData,{type:"image/jpeg"})),l.decoding="async";var c=function(){l.removeEventListener("error",d),l.removeEventListener("load",m)},d=function(){c(),window.URL.revokeObjectURL(l.src),e(i.Result.failure(new s.a({errorCode:"PreviewDataLoadFailed",message:"Preview data image load failed from CMM root for preview data hydrator"})))},m=function(){c();var n=r.a.instance.setPreviewData(t,u.keyAssetIdentifier,l);e(i.Result.success(n))};l.addEventListener("error",d),l.addEventListener("load",m)}else r.a.instance.setPreviewData(t,u.keyAssetIdentifier,void 0),e(i.Result.failure(new s.a({errorCode:"PreviewDataLoadFailed",message:"Empty array buffer for preview data hydrator"})))}catch(f){e(i.Result.failure(new s.a({errorCode:"PreviewDataLoadFailed",message:"Decoding failed in preview data load"})))}}))})).catch((function(){o.b.instance.report("previewDataFetchFailed"),e(i.Result.failure(new s.a({errorCode:"PreviewDataLoadFailed",message:"Fetch preview data failed for preview data hydrator"})))})).finally((function(){delete l[u.a.zoneKeyString(t)]}))}));return l[u.a.zoneKeyString(t)]=m,{promise:m,isLoading:!0}}},2534:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(1796);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,o(i.key),i)}}function o(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!==typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===typeof t?t:String(t)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var s=function(e){var t,n;function o(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).cachedImages={},t}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n);var s,u,l=o.prototype;return l.getPreviewData=function(e){return this.get(e)},l.setPreviewData=function(e,t,n){this.cachedImages[this.getKeyString(e)]=n;var i={keyAssetRecordName:t,zoneID:e};return this.set(e,i),i},l.deletePreviewData=function(e){var t=this.getKeyString(e),n=this.cachedImages[t];return n&&n.src&&(delete this.cachedImages[t],window.URL.revokeObjectURL(n.src)),this.delete(e)},l.getImageFromCacheOrClone=function(e,t){var n=this.cachedImages[this.getKeyString(e)];if(n){if(!n.parentNode||t&&t===n)return n;var i=new Image;return i.decoding="async",i.src=n.src,i}},l.getKeyString=function(e){return i.a.zoneKeyString(e)},s=o,u=[{key:"instance",get:function(){return this._instance||(this._instance=new o(100)),this._instance}}],null&&r(s.prototype,null),u&&r(s,u),Object.defineProperty(s,"prototype",{writable:!1}),o}(n(1800).a);s._instance=void 0},2535:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(2533),r=n(2534);function o(e,t,n){if(!t)return function(){};function o(e){if(t){var i=e.currentValue;i&&n(i)}}return Object(i.a)(e,t),r.a.instance.addListener(t,o),function(){r.a.instance.removeListener(t,o)}}},2536:function(e,t,n){},2537:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return m}));var i=n(2538),r=n(3136),o=n(2128),a=n(2112),s={PHOTOS:"ReviewTitleView.NumberOfPhotos",VIDEOS:"ReviewTitleView.NumberOfVideos",ITEMS:"ReviewTitleView.NumberOfItems"};function u(e,t){return e&&0!==e?Object(r.c)("ReviewTitleView.NumberOfSelectedItems",e):function(e){var t=e.fields,n=t.assetCount,i=t.photosCount,r=t.videosCount;return Object(o.b)(null!=n?n:0,null!=i?i:0,null!=r?r:0,s)}(t)}function l(e){if(!e)return"";var t=e.fields,n=t.startDate,i=t.endDate;return void 0===n&&(n=i),void 0===i&&(i=n),void 0===n?"":a.a.getCMMFormattedDateRangeString(new Date(n),new Date(i))}function c(e){return i.a.getExpiryDate(e)}function d(e){var t=new Date(Date.now()),n=new Date(e),i=Object(a.c)(n);if(0===i){var o=a.a.timeOnly(n);return Object(r.b)("Time.Remaining.Expires.Others",{date:o})}if(i>0)return Object(r.b)("Time.Remaining.Expires.Expired");if(-1===i)return Object(r.b)("Time.Remaining.Expires.Tomorrow");if(t.getFullYear()===n.getFullYear()){var s=a.a.fullMonthDay(n);return Object(r.b)("Time.Remaining.Expires.Others",{date:s})}var u=a.a.fullMonthDayYear(n);return Object(r.b)("Time.Remaining.Expires.Others",{date:u})}function m(e){var t=e.fields.startDate,n=e.fields.endDate;if(!t&&!n)return"";var i=new Date(t||n),r=new Date(n||t);return Object(a.c)(i)<=7&&i.getDate()===r.getDate()?a.a.getRelativeDateString(i):a.a.getCMMFormattedDateRangeString(i,r)}},2538:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.getExpiryDate=function(e){var t;return(null==e?void 0:e.fields.expiryDate)||(null==e||null==(t=e.pluginFields)?void 0:t.expiryDate)}}(i||(i={}))},2539:function(e,t,n){},2540:function(e,t,n){},2541:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u}));var i=n(1876),r=n(2389),o=n(2388),a=["isSingleColumn","mouseNavbarLayout"],s=1024;function u(e){var t,n,u=e.isSingleColumn,l=e.mouseNavbarLayout,c=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,a),d=Object(o.b)(c),m=c.primaryInteractionMode,f=c.sizeClass,h=c.viewportWidth;t=m===i.a.Touch?f===i.d.Compact?r.a.iCloudLinksInsetCompact:h<s?r.a.iCloudLinksInsetRegular:r.a.iCloudLinksInsetMouse:r.a.iCloudLinksInsetMouse,n=m===i.a.Touch?f===i.d.Compact?r.a.iCloudLinksColumnSpacingCompact:h<s?r.a.iCloudLinksColumnSpacingRegular:r.a.iCloudLinksColumnSpacingMouse:r.a.iCloudLinksColumnSpacingMouse;var v=f===i.d.Compact&&m===i.a.Touch?r.a.iCloudLinksRowSpacingCompact:r.a.iCloudLinksRowSpacingRegular,p=function(e){var t=e.primaryInteractionMode,n=e.viewportWidth;return e.isSingleColumn?1:e.sizeClass===i.d.Compact&&t===i.a.Touch?r.a.iCloudLinksColumnCountCompact:Math.floor(n/256)}({primaryInteractionMode:m,sizeClass:f,viewportWidth:h,isSingleColumn:u}),b=t;return m===i.a.Touch?b+=Object(o.c)():b+=Object(o.a)(l),Object.assign({},d,{numColumns:p,rowGap:v,columnGap:n,paddingInlineStart:n,paddingInlineEnd:n,paddingBlockStart:b,paddingBlockEnd:v,itemAspectRatio:r.a.iCloudLinksItemAspectRatio})}},3111:function(e,t,n){"use strict";n.r(t),n.d(t,"ICloudLinksGridPage",(function(){return ye}));var i=n(1343),r=n(2385),o=n(1450),a=n.n(o),s=n(3113),u=n(1796),l=n(2111),c=n(2064),d=n(1876),m=n(2389),f=n(2395),h=n(2533),v=n(2534),p=n(1798),b=(n(2532),n(2535));function y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,g(i.key),i)}}function g(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!==typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===typeof t?t:String(t)}function C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e,t){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var _=function(e){var t,n;function i(t){var n;return(n=e.call(this,t)||this).itemState=void 0,n._cmmRoot=void 0,n._cmmShare=void 0,n._lastRenderedCMM=void 0,n._cleanupPreviewDataListener=void 0,n.className="ICloudLinkItemView",n.itemState=void 0,n._handleCMMInfoChanged=n._handleCMMInfoChanged.bind(C(n)),n._handlePreviewDataChanged=n._handlePreviewDataChanged.bind(C(n)),n}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,w(t,n);var r,o,a=i.prototype;return a._handleCMMInfoChanged=function(e){var t;e.currentValue&&(this._cmmRoot=e.currentValue.cmmRoot,this._cmmShare=e.currentValue.cmmShare,this._cmmRoot&&null!=(t=this.itemState)&&t.cmmZoneID&&Object(h.a)(this._cmmRoot,this.itemState.cmmZoneID),this._updatePlugins())},a._handlePreviewDataChanged=function(e){e&&(this.fallbackImageElement||this.imageElement||(this.fallbackImageElement=v.a.instance.getImageFromCacheOrClone(e.zoneID,void 0)),e.keyAssetRecordName&&this.itemState&&this.itemState.cmmZoneID&&(this.itemState.assetKey={zoneID:this.itemState.cmmZoneID,recordName:e.keyAssetRecordName},this._handleAssetKeyChanged()),this._updateItemView())},a.render=function(t){var n=this.itemState;if(this.itemState){var i=null==n?void 0:n.cmmZoneID;if(i&&(!this._lastRenderedCMM||!p.a.isZoneIDEqual(i,this._lastRenderedCMM))){var r;this.fallbackImageElement=void 0,this._lastRenderedCMM&&s.a.instance.cmmInfoStore.removeListener(this._lastRenderedCMM,this._handleCMMInfoChanged),null==(r=this._cleanupPreviewDataListener)||r.call(this),s.a.instance.cmmInfoStore.addListener(i,this._handleCMMInfoChanged);var o=Object(l.a)(i).data;this._cmmRoot=null==o?void 0:o.cmmRoot,this._cmmShare=null==o?void 0:o.cmmShare,this._cmmRoot&&(this._cleanupPreviewDataListener=Object(b.a)(this._cmmRoot,i,this._handlePreviewDataChanged)),this._lastRenderedCMM=i}if(this.cmmRoot&&i&&!n.assetKey){var a=v.a.instance.getPreviewData(i);a&&(this.fallbackImageElement=v.a.instance.getImageFromCacheOrClone(i,this.fallbackImageElement),a.keyAssetRecordName&&(n.assetKey={zoneID:i,recordName:a.keyAssetRecordName}))}e.prototype.render.call(this,t)}},a.wasRemoved=function(){var t;this._lastRenderedCMM&&s.a.instance.cmmInfoStore.removeListener(this._lastRenderedCMM,this._handleCMMInfoChanged),null==(t=this._cleanupPreviewDataListener)||t.call(this),this._lastRenderedCMM=void 0,this._cmmRoot=void 0,this._cmmShare=void 0,this.fallbackImageElement=void 0,e.prototype.wasRemoved.call(this)},r=i,(o=[{key:"cmmRoot",get:function(){return this._cmmRoot}},{key:"cmmShare",get:function(){return this._cmmShare}}])&&y(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),i}(f.b),S=n(2541),O=n(2393);function I(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,E(i.key),i)}}function E(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!==typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===typeof t?t:String(t)}function j(e,t){return(j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var D=function(e){var t,n,i,r;function o(t){var n;return(n=e.call(this,t)||this).itemView=void 0,n.itemView=t,n}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,j(t,n),i=o,(r=[{key:"itemState",get:function(){return this.itemView.itemState}}])&&I(i.prototype,r),Object.defineProperty(i,"prototype",{writable:!1}),o}(O.a),M=(n(2536),n(2537));function L(e,t){return(L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var P=function(e){var t,n;function i(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this)._textContainer=void 0,t._titleElement=void 0,t._subtitleElement=void 0,t._prevTitle=void 0,t._prevSubtitle=void 0,t}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,L(t,n);var r=i.prototype;return r.update=function(e){this._textContainer||(this._textContainer=document.createElement("div"),this._textContainer.className="ICloudLinkOverlayItemViewPlugin",this.itemView.element.appendChild(this._textContainer)),this._updateTitle(),this._updateSubtitle()},r._updateTitle=function(){var e,t="",n=null==(e=this.itemView.cmmShare)?void 0:e.fields["cloudkit.title"],i=this.itemView.cmmRoot;n?t=n:i&&(t=Object(M.d)(i)),this._titleElement||(this._titleElement=document.createElement("div"),this._titleElement.className="ICloudLinkOverlayItemViewPlugin-title",this._textContainer.appendChild(this._titleElement)),t!==this._prevTitle&&(this._titleElement.textContent=t,this._prevTitle=t)},r._updateSubtitle=function(){var e,t=null==(e=this.itemView.cmmShare)?void 0:e.fields["cloudkit.title"],n=this.itemView.cmmRoot;if(n){var i=t?Object(M.d)(n):"";this._subtitleElement||(this._subtitleElement=document.createElement("div"),this._subtitleElement.className="ICloudLinkOverlayItemViewPlugin-subtitle",this._textContainer.appendChild(this._subtitleElement)),i!==this._prevSubtitle&&(this._subtitleElement.textContent=i,this._prevTitle=i)}},i}(D),R=n(3136),k=(n(2539),n(2355)),T=n(2531),x=n(2128),N=n(2401);function V(e,t){var n,i;e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n=e,i=t,(Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(n,i)}var A=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this)._textContainer=void 0,t._titleElement=void 0,t._subtitleElement=void 0,t._expiresElement=void 0,t._prevTitle=void 0,t._prevSubtitle=void 0,t._prevExpires=void 0,t}V(t,e);var n=t.prototype;return n.update=function(e){if(!this._textContainer){var t=document.createElement("div");this._textContainer=t,t.className="ICloudLinkTitleItemViewPlugin-textContainer",this.itemView.element.appendChild(t);var n=this;t.Gestures=[function(e){function t(){for(var t,i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).plugin=n,t}return V(t,e),t}(N.a)]}this._updateTitle(),this._updateSubtitle(),this._updateExpires()},n._updateExpires=function(){var e,t,n=Object(M.c)(this.itemView.cmmRoot);if(n){e=Object(M.a)(n);var i=n-Date.now();t=Math.floor(i/864e5)<=m.a.shareExpirationImminentThresholdInDays}this._expiresElement||(this._expiresElement=document.createElement("div"),this._expiresElement.className="ICloudLinkTitleItemViewPlugin-expires "+(t?"expiration-imminent":""),this._textContainer.appendChild(this._expiresElement)),this._prevExpires!==e&&e&&(this._expiresElement.textContent=e,this._prevExpires=e)},n._updateSubtitle=function(){var e=this.itemView.cmmRoot,t="";if(e&&e.fields&&e.fields.videosCount&&e.fields.photosCount){var n=e.fields.videosCount+e.fields.photosCount;t=Object(R.c)("ItemCount",n)}else e&&(t=Object(x.a)(e));this._subtitleElement||(this._subtitleElement=document.createElement("div"),this._subtitleElement.className="ICloudLinkTitleItemViewPlugin-subtitle",this._textContainer.appendChild(this._subtitleElement)),t!==this._prevSubtitle&&(this._subtitleElement.textContent=t,this._prevSubtitle=t)},n._updateTitle=function(){var e,t,n,i=!1,r=this.itemView.cmmShare;Object(k.a)(r)?(e=Object(R.b)("ShareListingItemView.Title.YouShared"),t="ICloudLinkTitleItemViewPlugin-title ICloudLinkTitleItemViewPlugin-youShared",i=!0):(e=(null==(n=T.a.getNameOrEmailString(r))?void 0:n.fullName)||"",t="ICloudLinkTitleItemViewPlugin-title"),this._titleElement||(this._titleElement=document.createElement("div"),this._titleElement.className=t,this._textContainer.appendChild(this._titleElement)),e!==this._prevTitle&&(i?this._titleElement.innerHTML=e:this._titleElement.textContent=e,this._prevTitle=e)},t}(D),z=n(2075),Z=(n(2540),n.p+"images/4cd4a47b9724069224c3bcf1b503f190.png"),B=n.p+"images/a969ecfa11a0b85793b0794b3b798634.png",F=n.p+"images/e6afb4f12499de0ade576201cf8760c8.png";function K(e,t){var n,i;e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n=e,i=t,(Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(n,i)}function U(e,t){return(U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var G=function(e){var t,n;function i(t){var n;return(n=e.call(this,t)||this).itemView=void 0,n.itemView=t,n}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,U(t,n);var r=i.prototype;return r.needsButton=function(){var e;return Boolean(this.itemView.cmmRoot&&(null==(e=this.itemView.itemState)?void 0:e.editModeIsActive))},r.getLabel=function(){return T.a.getCMMOwner(this.itemView.cmmShare),Object(R.b)("DeleteButton.ShareListing.Owned.Tooltip")},i}(function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this)._deleteButtonElement=void 0,t}return K(t,e),t.prototype.update=function(e){if(this.needsButton()){if(!this._deleteButtonElement){var t=this,n=document.createElement("button");n.className="DeleteButtonItemViewPlugin";var i=document.createElement("img");i.srcset=Z+" 1x, "+B+" 2x, "+F+" 3x",n.appendChild(i),n.Gestures=[function(e){function n(){return e.apply(this,arguments)||this}return K(n,e),n.prototype.buttonAction=function(e){t.activate(e)},n}(z.a)],this.itemView.element.appendChild(n),this._deleteButtonElement=n}var r=this.getLabel();this._deleteButtonElement.setAttribute("aria-label",r)}else this._deleteButtonElement&&(this._deleteButtonElement.remove(),this._deleteButtonElement=void 0)},t}(O.a)),W=n(1944),Y=n(3245),H=n(3140);function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function J(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,q(i.key),i)}}function q(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!==typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===typeof t?t:String(t)}function Q(e,t){var n,i;e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n=e,i=t,(Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(n,i)}var X=function(e){function t(t){var n;(n=e.call(this,Object.assign({},t,{initialScrollPosition:c.b.Start}))||this).onDelete=void 0,n.orderedZones=void 0,n._lastUpdateTime=void 0,n._mouseNavbarLayout=void 0,n.onDelete=t.onDelete,n._mouseNavbarLayout=t.mouseNavbarLayout,n.handleZonesChange=n.handleZonesChange.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n)),s.a.instance.zoneStore.addCMMZonesListener(n.handleZonesChange);var i=s.a.instance.zoneStore.cmmZones;return i&&n.sortAndSaveZones(i),n}Q(t,e);var n,i,r=t.prototype;return r.destroy=function(){s.a.instance.zoneStore.removeCMMZonesListener(this.handleZonesChange),e.prototype.destroy.call(this)},r.sortAndSaveZones=function(e){var t=this,n={},i=[],r=Date.now();this._lastUpdateTime=r;for(var o,a=function(){var e=o.value,t=u.a.zoneKeyString(e.zoneID),r=Object(l.a)(e.zoneID),a=r.data,s=r.promise;if(a&&a.cmmRoot.fields.createDate)n[t]=a.cmmRoot.fields.createDate;else if(s){var c=s.then((function(e){e.ok&&e.value.cmmRoot.fields.createDate&&(n[t]=e.value.cmmRoot.fields.createDate)}));i.push(c)}},s=function(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return $(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$(e,void 0):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e);!(o=s()).done;)a();Promise.all(i).then((function(){if(!(t._lastUpdateTime&&t._lastUpdateTime>r)){var i=e.filter((function(e){return!!n[u.a.zoneKeyString(e.zoneID)]}));t.orderedZones=i.sort((function(e,t){var i=n[u.a.zoneKeyString(e.zoneID)];return n[u.a.zoneKeyString(t.zoneID)]-i})),t.grid&&void 0!==t.numItems?(t.grid.numItems=t.numItems,t.onNumItemsChange&&t.onNumItemsChange(t.numItems)):(t.initializeGridIfReady(),t.onNumItemsChange&&void 0!==t.numItems&&t.onNumItemsChange(t.numItems))}}))},r.handleZonesChange=function(e){e.currentValue&&this.sortAndSaveZones(e.currentValue)},r.initializeSelection=function(){this.selectionAPI.setSelectMode(W.SelectMode.Disabled)},r.createItemView=function(){var e=this.onDelete,t=this.onNavigate;return new _({itemViewPlugins:[P,function(e){function n(){return e.apply(this,arguments)||this}return Q(n,e),n.prototype.activate=function(){t(this.itemView)},n}(A),Object(Y.a)(t),function(t){function n(){return t.apply(this,arguments)||this}return Q(n,t),n.prototype.activate=function(){this.itemView.cmmShare&&e(this.itemView.cmmShare)},n}(G)]})},r.itemStateForIndex=function(t){var n,i=e.prototype.itemStateForIndex.call(this,t);return i.cmmZoneID=this.orderedZones?null==(n=this.orderedZones[t])?void 0:n.zoneID:void 0,i.isCover=!0,i.editModeIsActive=this._editModeIsActive,i},r.handleScrollFinished=function(){},r.handleVisibleIndexesChange=function(){},n=t,(i=[{key:"mouseNavbarLayout",set:function(e){this._mouseNavbarLayout=e,this.grid&&this.grid.setLayoutMetrics(this.layoutMetrics,!0)}},{key:"numItems",get:function(){var e;return null==(e=this.orderedZones)?void 0:e.length}},{key:"layoutMetrics",get:function(){var e=this.container.clientWidth,t=this.environmentState.primaryInteractionMode===d.a.Touch&&this.environmentState.sizeClass===d.d.Compact&&e<480&&!!this.numItems&&this.numItems<=m.a.iCloudLinksSingleColThreshold;return Object(S.b)(Object.assign({},this.environmentState,{viewportWidth:e,isSingleColumn:t,mouseNavbarLayout:this._mouseNavbarLayout,itemDisplayMode:Object(H.b)(this.environmentState)}))}}])&&J(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),t}(H.a),ee=n(2366),te=n(2413),ne=n(2089),ie=n(1661),re=n(3200),oe=n(3176),ae=function(e){var t=i.useRef(),n=Object(ee.b)(),r=i.useMemo((function(){return n?"headerOnly":"headerAndToolbar"}),[n]);i.useEffect((function(){t.current&&(t.current.mouseNavbarLayout=r)}),[r]);var o=Object(ne.e)(),s=function(e){return!1},l=i.useCallback((function(e){var n=new X(Object.assign({},e,{keyboardActionAllowedFn:s,onDelete:function(e){Object(oe.a)({cmmShare:e})},mouseNavbarLayout:r,onNavigate:function(e){var t,n,i=null==(t=e.cmmRoot)?void 0:t.shortGUID,r=null==(n=e.cmmRoot)?void 0:n.zoneID;i&&o&&r&&(ie.b.instance.report("cmmShareGridItemPressed"),re.a.instance.setGridState(u.a.cmmListKeyForZoneID(r),"scrollState",void 0),o(i))}}));return t.current=n,n}),[r,o]);return i.createElement(te.a,{className:a()("ICloudLinksGridWrapper",e.className),gridKey:"ICloudLinks",createGrid:l,emptyPageComponent:e.emptyPageComponent})},se=n(1892);function ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}n(2530);var le=n(1875),ce=n(2164),de=n(3141),me=n(2375),fe=n(2134),he=n(3189),ve=n(2381),pe=n(2373),be=n(2415),ye=function(e){var t=e.route,n=function(){var e=i.useCallback((function(e){for(var t,n=[],i=[],r=function(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return ue(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ue(e,void 0):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e);!(t=r()).done;){var o=t.value,a=Object(l.a)(o.zoneID),s=a.data,u=a.promise;null!=s&&s.cmmShare?i.push(s.cmmShare):u&&n.push(u.then((function(e){return e.ok?e.value.cmmShare:void 0})))}return{shareData:i,sharePromises:n}}),[]),t=i.useState(!1),n=t[0],r=t[1],o=i.useState(s.a.instance.zoneStore.cmmZones),a=o[0],u=o[1],c=i.useState((function(){if(a){var t=e(a),n=t.shareData;return 0===t.sharePromises.length?T.a.getCMMCountsByOwner(n):void 0}})),d=c[0],m=c[1],f=Object(se.a)();return i.useEffect((function(){var e=function(e){u(e.currentValue)};s.a.instance.zoneStore.addCMMZonesListener(e);var t=s.a.instance.zoneStore.cmmZones;return u(t),function(){s.a.instance.zoneStore.removeCMMZonesListener(e)}}),[]),i.useEffect((function(){if(a){var t=e(a),n=t.shareData,i=t.sharePromises;i.length>0?(r(!0),Promise.all(i).then((function(e){if(f()){r(!1);var t=[].concat(e,n).filter((function(e){return!!e}));m(T.a.getCMMCountsByOwner(t))}}))):m(T.a.getCMMCountsByOwner(n))}}),[a,f,e]),{countByOwner:d,isDataLoading:n}}().countByOwner,o=t.data.gridKey,u=n?n.you+n.others:void 0,c=n&&0!==u?Object(R.a)("Grid.View.Header.ShareListing.CountsSharedByYouAndOthers",n.you,n.others):void 0,m=Object(le.b)().primaryInteractionMode===d.a.Mouse,f=Object(ne.h)();i.useEffect((function(){return he.a.instance.startPolling(),function(){he.a.instance.stopPolling()}}),[]);var h=i.useCallback((function(){Object(fe.c)(fe.a.Library,f)}),[f]),v=i.useMemo((function(){var e=void 0!==u&&u>0;return i.createElement(pe.a,{touchRegularNavbar:i.createElement(de.b,{needsEditButton:e}),touchCompactNavbar:i.createElement(de.b,{needsEditButton:e}),mouseToolbar:i.createElement(me.c,null),mouseGridHeader:i.createElement(r.a,{title:Object(R.b)("ICloudLinksGridPage.Title"),description:c,gridKey:o})})}),[u,c,o]);Object(ve.b)(v,t);var p=Object(ce.b)().isDomainCN;return i.createElement("div",{className:"ICloudLinksGridPage"},i.createElement(ae,{className:a()({"has-grid-header":m}),emptyPageComponent:i.createElement(be.a,{description:Object(R.b)("ShareListing.StartSharing.Label"),onClick:h,buttonText:p?void 0:Object(R.b)("ShareListing.StartSharing.Button")})}))}}}]);